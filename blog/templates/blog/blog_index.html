{% extends "base.html" %}

{% load static wagtailcore_tags wagtailimages_tags blogapp_tags wagtailroutablepage_tags  %}
{% load menu_tags %}

{% block extra_css %}
{% comment %} <link rel="stylesheet" href="{% static '/blog/css/materialize.min.css' %}"> {% endcomment %}
<style>
.form-group input[type="checkbox"] {
    display: none;
}
.form-group input[type="checkbox"] + .btn-group > label span {
    width: 20px;
}
.form-group input[type="checkbox"] + .btn-group > label span:first-child {
    display: none;
}
.form-group input[type="checkbox"] + .btn-group > label span:last-child {
    display: inline-block;   
}

.form-group input[type="checkbox"]:checked + .btn-group > label span:first-child {
    display: inline-block;
}
.form-group input[type="checkbox"]:checked + .btn-group > label span:last-child {
    display: none;   
}

</style>
{% endblock %}
{% comment %} {% block sidebar_items %}
<li class="nav-item">
    <form role="search" method="get" class="form-search" action="{% routablepageurl blog_page "post_search" %}" method="get">
        <div class="input-group">
            <input type="text" class="form-control search-query" name="q" placeholder="Search&hellip;" title="Search for:" />
            <span class="input-group-btn">
                <button type="submit" class="btn btn-default" id="searchsubmit">
                <i class="fas fa-search"></i>
                </button>
            </span>
        </div>
    </form>
</li>
<li class="nav-item">
    <a class="nav-link pl-0" href="#">Link</a>
</li>

{% main_menu template="menu/b4_menu.html" %}


{% endblock %} {% endcomment %}

{% block content %}
    <section class="callout">
        <div class="container text-center">
            <h2 class="mx-auto mb-5">{{ blog_index.title_caption }}</h2>
            <h6 class="mb-5">
            <em>from ABCD studio</em>
            </h6>
        </div>
    </section>

    <section class='' id='posts_region'>
    <div class='container'>
    <h1>  最新貼文  </h1>
    ... should add next few page buttons
    {% if p %}
    <h3>this is page {{ p }}</h3>
    {% endif %}

        <div class="list-group">
            {% for post in posts_this_page %}
            <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" href="/blog/{{ post.slug }}">
                {{ post.title }}
                {% with categories=post.categories.all %}
                {% if categories %}
                <div>
                    {% for category in categories %}
                    <span class='badge badge-info badge-pill' >{{ category.name }}</span>
                    {% endfor %}
                </div>
                {% endif %}{% endwith %}
            </a>
            {% endfor %}
        </div>

    </section>
    <br>

    {% comment %} <p>
        <span class="fas fa-calendar-alt"></span> {{post.date|date:"D d M Y"}} &nbsp;
        <span class="fas fa-user"></span> {{post.owner}} &nbsp;
    </p> {% endcomment %}
    
    {% comment %} {% for post in posts %}
        {% if post.header_image %}
            {% image post.header_image original as header_image %}
            <img src="{{ header_image.url }}" class="img-responsive" ></img>
        {% endif %}
        <h2>
            <a href="{% post_date_url post blog_page %}">{{ post.title }}</a>
        </h2>
        <p>
            <span class="glyphicon glyphicon-time"></span>
            Posted on {{post.date}} by {{post.owner}}
        </p>
        <hr>
        {% if post.excerpt %}
            {{ post.excerpt|richtext }}
        {% else %}
            {{ post.body|richtext|truncatewords_html:40 }}
        {% endif %}
        <a class="btn btn-primary" href="{% post_date_url post blog_page %}">
        Read More <span class="glyphicon glyphicon-chevron-right"></span>
        </a>
        <hr>
    {% endfor %} {% endcomment %}

<section class="">
<div class='container bg-light' align='center' style="padding-top:5rem;padding-bottom:5rem">
<h3>以類別搜尋po文：</h3>
<br>
<form action='http://127.0.0.1:8000/blog/category/' method='POST'>
    {% csrf_token %}

{% for category in categories %}
    {% if forloop.counter0|divisibleby:3 %}
    <div class='row justify-content-md-center'>
    {% endif %}
    <div class='col-md-3'>
        <div class="form-group">
            <input type="checkbox" name="{{ category.name }}" id="{{ category.name }}" autocomplete="off" />
            <div class="btn-group">
                <label for="{{ category.name }}" class="btn btn-primary">
                    <span class="fas fa-check"></span>
                    <span> </span>
                </label>
                <label for="{{ category.name }}" class="btn btn-default active" style="width: 120px">
                    {{ category.name }}
                </label>
            </div>
        </div>
    </div>
    {% cycle "" "" "</div>" %}

{% endfor %}
{% if n_category_left == 1 %}
    <div class='col-md-3'></div>
    <div class='col-md-3'></div>
    </div>
{% elif n_category_left == 2 %}
    <div class='col-md-3'></div>
    </div>
{% endif %}
<input type='submit' class='btn btn-success' value='查詢'>
</div>
</form>
</section>
   {% include 'footer.html' %}
{% endblock %}